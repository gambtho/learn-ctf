<!DOCTYPE html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="alternate" href="/index.xml" type="application/rss+xml" title="GreyHat CTF Educational Content">
		<link rel="icon" href="http://learn.greyhatctf.com/favicon.ico">
		<title>Nmap - GreyHat CTF Educational Content</title>
		
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/highlight/default.css">
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/bootstrap.min.css">
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/bootstrap-theme.min.css">
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/theme.css">
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/bootie-docs.css">
		<link rel="stylesheet" href="http://learn.greyhatctf.com/css/site.css">
	</head>

<body role="document">

	
	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="http://learn.greyhatctf.com/">GreyHat CTF Educational Content</a>
			</div>
			<div id="navbar" class="navbar-collapse collapse">
				<ul class="nav navbar-nav">
					<li ><a href="http://learn.greyhatctf.com/">Home</a></li>
			
			
				
					<li ><a href="/attack/">attack</a></li>
				
					<li ><a href="/defense/">defense</a></li>
				
			
				
				</ul>
				
			</div>
		</div>
	</nav>

<div class="container">


<div class="row">
	<div class="col-sm-8 doc-main">
		<main role="main">
			<article>
				<a id="title"></a>
				<h1 class="doc-entry-title">Nmap</h1>
				<div class="doc-entry-meta">
					<span><time datetime="2017-07-24">July 24, 2017</time></span>
				</div>
				<section>
					

<h1 id="introduction">Introduction</h1>

<p>Nmap is a widely used network scanning and mapping tool. It is an open source command line tool, but there are GUI front ends such as Zenmap that can be used with Nmap.</p>

<p>Nnap can be used to scan networks or single hosts. It uses a variety of scanning techniques that include standard IP implementations and modified IP implementations. Nmap is also extensible using the Nmap Scripting Engine (NSE) to write custom scanning scripts.</p>

<p>Using Nmap is generally a four step process:</p>

<ol>
<li>Discover hosts on network</li>
<li>Port scan specific hosts</li>
<li>Enumerate services on host and fingerprint OS</li>
<li>Run NSE scripts for further enumeration or exploitation of host</li>
</ol>

<h1 id="basic-usage">Basic Usage</h1>

<pre><code class="language-bash">nmap [Scan Type(s)] [Options] {target specification}
</code></pre>

<h1 id="basic-examples">Basic Examples</h1>

<p>Ping scan single network and disable DNS lookup</p>

<pre><code class="language-bash">nmap -n -sn 10.0.1.0/24
</code></pre>

<p><img src="/attack/nmap_default.png" alt="Nmap default scan" /></p>

<p>Scan network by IP range</p>

<pre><code class="language-bash">nmap 10.0.0-255.1-254
</code></pre>

<p>Scan single host using default ports</p>

<pre><code class="language-bash">nmap 192.168.222.159
</code></pre>

<p>Enumerate services, fingerprint OS, and run script scans on single host</p>

<pre><code>nmap -A 192.168.222.159
</code></pre>

<p>Run vsftpd backdoor script scan on single host</p>

<pre><code>nmap --script ftp-vsftpd-backdoor 192.168.222.159
</code></pre>

<p><img src="/attack/nmap_vsftpd_script.png" alt="Nmap vsftpd script scan" /></p>

<h1 id="specifying-ports">Specifying ports</h1>

<p>By default Nmap only scans the top 1000 most frequently used ports. The list of port frequencies can be found the nmap-services file. Assuming your services file is contained in /usr/share/nmap/ directory you can run</p>

<pre><code>sort -r -k3 /usr/share/nmap/nmap-services | grep tcp | head -n 100
</code></pre>

<p>to print the top 100 most frequently used TCP ports.</p>

<p>You can control which ports are scanned by specifying ports in your Nmap command with -p option.</p>

<p>Scan only port 80</p>

<pre><code>nmap 192.168.222.159 -p80
</code></pre>

<p>Scan port 80 and 443</p>

<pre><code>nmap 192.168.222.159 -p80,443
</code></pre>

<p>Scan ports 1 to 1024</p>

<pre><code>nmap 192.168.222.159 -p1-1024
</code></pre>

<p>Scan UDP ports 53,111,137</p>

<pre><code>nmap 192.168.222.159 -sU -p U:53,111,137
</code></pre>

<p>Scan ports 1 to 1024 but exclude all ports from 500 to 900</p>

<pre><code>nmap 192.168.222.159 -p1-1024 --exclude-ports 500-900 
</code></pre>

<p>Scan all ports</p>

<pre><code>nmap 192.168.222.159 -p-
</code></pre>

<h1 id="nmap-scripting-engine-nse">Nmap Scripting Engine (NSE)</h1>

<p>The NSE scripts are typically located in /usr/share/nmap/scripts/ or /usr/local/share/nmap/scripts for Linux or C:\Program Files\Nmap\scripts for Windows.</p>

<p>A count of the files in scripts directory reveals that Nmap v7.50 comes preloaded with 567 scripts. Many scripts for testing or even exploiting various services and vulnerabilities exist. There are too many scripts to discuss all of them here in this article. The best thing to do is read the script documentation in the script file and/or try the script on vulnerable and non-vulnerable hosts to see what the results look like.</p>

<p>If a script that meets your needs doesn&rsquo;t exist you can write your own. NSE scripts are written in Lua.</p>

<h1 id="references">References</h1>

<ol>
<li><a href="https://nmap.org/">Nmap: The Network Mapper</a></li>
<li><a href="http://www.nullsec.us/top-1-000-tcp-and-udp-ports-nmap-default/">Top 1,000 TCP and UDP ports (nmap default)</a></li>
<li><a href="https://gist.github.com/bonsaiviking/10402038">Guide to using Nmap to scan for the Heartbleed bug</a></li>
</ol>

				</section>
			</article>
		</main>
	</div> 

	

<div class="col-sm-3 col-sm-offset-1 doc-sidebar">
	<div id="sidebar">
	<div class="sidebar-module">
		<div class="sidebar-toc">
			<h4 class="sidebar-heading">Table of Contents</h4>
			<ul>
				<li><strong><a href="#title">Nmap</a></strong></li>
			</ul>
			<nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#basic-examples">Basic Examples</a></li>
<li><a href="#specifying-ports">Specifying ports</a></li>
<li><a href="#nmap-scripting-engine-nse">Nmap Scripting Engine (NSE)</a></li>
<li><a href="#references">References</a></li>
</ul>
</nav>
		</div>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Pages in Categories</h4>
		<ul class="sidebar-category-list">
		
			<li>
				<a href="http://learn.greyhatctf.com/categories/attack">
					<span class="doc-list-category">Attack</span>
				</a>
				<ul>
					<li><a href="/attack/attack_lifecycle/">The Cyber Attack Lifecycle #Draft</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="http://learn.greyhatctf.com/categories/defense">
					<span class="doc-list-category">Defense</span>
				</a>
				<ul>
					<li><a href="/defense/introduction/">Threat Detection Introduction</a>
					</li>
				
				</ul>
			</li>
		
		</ul>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Tags</h4>
		<div class="tag-box">
		
			<a class="tag-item" href="http://learn.greyhatctf.com/tags/logs">logs</a>
		
			<a class="tag-item" href="http://learn.greyhatctf.com/tags/reference">reference</a>
		
		</div>
	</div>
	</div>
</div>

</div> 



<footer class="doc-footer">
  <p>&copy; 2017 GreyHat CTF Educational Content</p>
  <p>Powered by <a href="http://gohugo.io" target="_blank">Hugo</a>,</p>
</footer>

